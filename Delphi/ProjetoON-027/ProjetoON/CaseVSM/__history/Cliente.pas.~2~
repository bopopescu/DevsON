unit Cliente;



interface

uses frmDataModulo, Data.DB;

type
  TCliente = class
  function SetPersisteCliente : Integer;
  function StateCliente : Boolean;
  function UltimoCodCli : Integer;
  end;

implementation

{ TCliente }



function TCliente.SetPersisteCliente;
begin
    // Persistir o cliente
      frmDataModulo.DataModule1.cdsClientes.Post;
      frmDataModulo.DataModule1.cdsClientes.ApplyUpdates(0);

      if frmDataModulo.DataModule1.cdsClientesCODCLI.AsString.IsEmpty then
        Result := ultimoCodcli
      else
        Result := frmDataModulo.DataModule1.cdsClientesCODCLI.AsInteger;
end;



function TCliente.StateCliente: Boolean;
begin
    Result :=  (frmDataModulo.DataModule1.cdsClientes.State = dsInsert );
end;

function TCliente.UltimoCodCli: Integer;
begin
    ///
    frmDataModulo.DataModule1.SQL.close;
    frmDataModulo.DataModule1.SQL.open;
    Result := frmDataModulo.DataModule1.SQL.FieldByName('CODCLI').AsInteger;
end;

end.
